<!DOCTYPE html>
<!--==============================================================================
	           "GitHub HTML5 Pandoc Template" v1.2 — by Tristano Ajmone
	==============================================================================
	(c) Tristano Ajmone, 2017, MIT License (MIT). Project's home repository:

	- https://github.com/tajmone/pandoc-goodies

	This template reuses source code taken from the following projects:

	- GitHub Markdown CSS: © Sindre Sorhus, MIT License (MIT):
	  https://github.com/sindresorhus/github-markdown-css

	- Primer CSS: © 2016 GitHub Inc., MIT License (MIT):
	  http://primercss.io/
	==============================================================================-->
<html>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Yutaka Masuda" />
  <title>Numerical examples from Mrode (2014)</title>
  <style type="text/css">@font-face{font-family:octicons-link;src:url(data:font/woff;charset=utf-8;base64,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) format('woff')}.markdown-body{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#24292e;font-family:-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-size:16px;line-height:1.5;word-wrap:break-word;box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto;padding:45px}.markdown-body .octicon{display:inline-block;fill:currentColor;vertical-align:text-bottom}.markdown-body a{background-color:transparent;-webkit-text-decoration-skip:objects;color:#0366d6;text-decoration:none}.markdown-body a:active,.markdown-body a:hover{outline-width:0}.markdown-body h1{margin:.67em 0}.markdown-body img{border-style:none}.markdown-body svg:not(:root){overflow:hidden}.markdown-body code,.markdown-body kbd,.markdown-body pre{font-family:monospace,monospace}.markdown-body input{font:inherit;margin:0;overflow:visible;font-family:inherit;font-size:inherit;line-height:inherit}.markdown-body [type=checkbox]{box-sizing:border-box;padding:0}.markdown-body *{box-sizing:border-box}.markdown-body a:hover{text-decoration:underline}.markdown-body strong{font-weight:600}.markdown-body hr{box-sizing:content-box;overflow:hidden;background:0 0;border-bottom:1px solid #dfe2e5}.markdown-body hr::before{display:table;content:""}.markdown-body hr::after{display:table;clear:both;content:""}.markdown-body table{border-spacing:0;border-collapse:collapse;display:block;width:100%;overflow:auto}.markdown-body td,.markdown-body th{padding:0}.markdown-body blockquote{margin:0}.markdown-body ol ol,.markdown-body ul ol{list-style-type:lower-roman}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type:lower-alpha}.markdown-body dd{margin-left:0}.markdown-body code{font-family:SFMono-Regular,Consolas,"Liberation Mono",Menlo,Courier,monospace}.markdown-body pre{font:12px SFMono-Regular,Consolas,"Liberation Mono",Menlo,Courier,monospace;word-wrap:normal}.markdown-body .pl-0{padding-left:0!important}.markdown-body .pl-1{padding-left:4px!important}.markdown-body .pl-2{padding-left:8px!important}.markdown-body .pl-3{padding-left:16px!important}.markdown-body .pl-4{padding-left:24px!important}.markdown-body .pl-5{padding-left:32px!important}.markdown-body .pl-6{padding-left:40px!important}.markdown-body::before{display:table;content:""}.markdown-body::after{display:table;clear:both;content:""}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:0}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e1e4e8;border:0}.markdown-body blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd{font-size:11px;box-shadow:inset 0 -1px 0 #959da5}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1{padding-bottom:.3em;font-size:2em;border-bottom:1px solid #eaecef}.markdown-body h2{padding-bottom:.3em;font-size:1.5em;border-bottom:1px solid #eaecef}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#6a737d}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:600}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table th{font-weight:600}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #dfe2e5}.markdown-body table tr{background-color:#fff;border-top:1px solid #c6cbd1}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body code{padding:.2em 0;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code::after,.markdown-body code::before{letter-spacing:-.2em;content:"\00a0"}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:0 0;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px}.markdown-body pre code{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code::after,.markdown-body pre code::before{content:normal}.markdown-body .full-commit .btn-outline:not(:disabled):hover{color:#005cc5;border-color:#005cc5}.markdown-body kbd{display:inline-block;padding:3px 5px;font:11px SFMono-Regular,Consolas,"Liberation Mono",Menlo,Courier,monospace;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fcfcfc;border:1px solid #c6cbd1;border-bottom-color:#959da5;border-radius:3px;box-shadow:inset 0 -1px 0 #959da5}.markdown-body :checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}.markdown-body .task-list-item{list-style-type:none}.markdown-body .task-list-item+.task-list-item{margin-top:3px}.markdown-body .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}.markdown-body hr{border-bottom-color:#eee}.flash{position:relative;padding:16px;color:#246;background-color:#e2eef9;border:1px solid #bac6d3;border-radius:3px}.flash p:last-child{margin-bottom:0}.flash-messages{margin-bottom:24px}.flash-warn{color:#4c4a42;background-color:#fff9ea;border-color:#dfd8c2}.flash-error{color:#911;background-color:#fcdede;border-color:#d2b2b2}.flash-success{color:#22662c;background-color:#e2f9e5;border-color:#bad3be}.flash-plain{color:#4c4a42;background-color:#f5f5f5;border-color:#c1c1c1}</style>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">pre[data-language='renumf90']{background-color:#EFEFFE;}</style>
  <style type="text/css">pre[data-language='blupf90']{background-color:#E7FFE7;}</style>
  <style type="text/css">pre[data-language='output']{background-color:#FFFFFF;border:thin solid black;}</style>
  <style type="text/css">pre[data-language='shell']{background-color:#FFFFFF;border:thin dashed;}</style>
  <style type="text/css">pre[data-caption]::before{content:attr(data-caption) "\a\a";font-size:large;font-weight:bold;border-bottom:thin solid black}</style>
  <script src="/usr/share/javascript/mathjax/MathJax.js"
  type="text/javascript"></script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<article class="markdown-body">
<header>
<h1 class="title">Numerical examples from Mrode (2014)</h1>
<p class="author">Yutaka Masuda</p>
<p class="date">April 2025</p>
</header>
<nav id="TOC">
<ul>
<li><a href="#animal-model-with-unknown-parent-groups"
id="toc-animal-model-with-unknown-parent-groups">Animal model with
unknown parent groups</a>
<ul>
<li><a href="#short-introduction-to-unknown-parent-groups"
id="toc-short-introduction-to-unknown-parent-groups">Short introduction
to unknown parent groups</a></li>
<li><a href="#model" id="toc-model">Model</a></li>
<li><a href="#files" id="toc-files">Files</a></li>
<li><a href="#solutions" id="toc-solutions">Solutions</a></li>
</ul></li>
</ul>
</nav>
<p>
Back to <a href="./index.html">index.html</a>.
</p>
<h1 id="animal-model-with-unknown-parent-groups">Animal model with
unknown parent groups</h1>
<h2 id="short-introduction-to-unknown-parent-groups">Short introduction
to unknown parent groups</h2>
<p>Unknown parent groups (as known as genetic groups or phantom groups)
are one of the less-understood concepts in animal breeding. We usually
assume the mean breeding value in a base population is 0. The average
breeding value by generation or birth year will increase (or decrease)
by selection. If we have complete pedigree back to the base population,
the complete phenotype used as the selection criterion and an
appropriate model to describe the factors for observation, the mixed
model can provide an unbiased prediction of breeding values for all
animals. But the reality is different. One of the biggest challenges is
incomplete pedigree. Many young animals may have no pedigree information
in a population undergoing selection. In this case, it is an incorrect
assumption that unknown parents belong to the base population. Under the
selection, younger animals have significantly higher (or lower) genetic
base so their parents should have a nonzero average of breeding
values.</p>
<p>The genetic group can partially solve this problem. A genetic group
looks like a real animal. We assign a group to unknown parents that are
expected to have the same genetic level. A group to be assigned to
parents in the younger generation should be different from a group for
older parents because of different genetic levels. In addition to
generation (or birth year), the group may also be defined by sex, a
region of origin, and the selection path. Because the group is a proxy
of the base animal, every real animal is a descendant of genetic
groups.</p>
<p>The groups are likely treated as fixed effects. The expectation of
breeding value of the base animals is no longer 0, and it will be
replaced with BLUE for the group effect. Therefore, the final prediction
of breeding value for an animal is a mixture of BLUE for the group
effect and BLUP for the breeding value. In spite of this complication,
the mixed model equations with groups are surprisingly simple and look
like one from the standard animal model. For theoretical background, see
the textbook in addition to Westell and Van Vleck (1987) and Quaas
(1988) for details.</p>
<h2 id="model">Model</h2>
<p>The mixed model with unknown-parernt groups can be written as follows
<span class="math display">\[
\mathbf{y} = \mathbf{Xb} + \mathbf{ZQg} + \mathbf{Zu} + \mathbf{e}
\]</span> where <span class="math inline">\(\mathbf{Q}\)</span> is a
matrix relates the groups to descendant animals and <span
class="math inline">\(\mathbf{g}\)</span> is the fixed effect for
groups. We are interested in <span
class="math inline">\(\mathbf{u^*}=\mathbf{u} + \mathbf{Qg}\)</span>,
that is, the prediction of breeding value of the individual adjusted by
the group effect accounting for the non-zero expectation of base
breeding values. Assuming a single-trait model, the resulting system of
mixed model equations is <span class="math display">\[
\left[
\begin{array}{lll}
\mathbf{X}&#39;\mathbf{R}^{-1}\mathbf{X} &amp;
\mathbf{X}&#39;\mathbf{R}^{-1}\mathbf{Z} \\
\mathbf{Z}&#39;\mathbf{R}^{-1}\mathbf{X} &amp;
\mathbf{Z}&#39;\mathbf{R}^{-1}\mathbf{Z} +
\mathbf{A}_{nn}^{-1}/\sigma_u^{2} &amp;
\mathbf{A}_{np}^{-1}/\sigma_u^{2}\\
\mathbf{0}&amp;\phantom{\mathbf{Z}&#39;\mathbf{R}^{-1}\mathbf{Z}+\,\,}\mathbf{A}_{pn}^{-1}/\sigma_u^{2}
&amp; \mathbf{A}_{pp}^{-1}/\sigma_u^{2}
\end{array}
\right]
\left[
\begin{array}{l}
\mathbf{\hat{b}}\\
\mathbf{\hat{u}^*}
\\
\mathbf{\hat{g}}\\
\end{array}
\right]
=
\left[
\begin{array}{l}
\mathbf{X}&#39;\mathbf{R}^{-1}\mathbf{y} \\
\mathbf{Z}&#39;\mathbf{R}^{-1}\mathbf{y} \\
\mathbf{0}
\end{array}
\right]
\]</span> and <span class="math display">\[
\mathbf{A}^{-1}
=
\left[
\begin{array}{ll}
\mathbf{A}_{nn}^{-1} &amp; \mathbf{A}_{np}^{-1} \\
\mathbf{A}_{pn}^{-1} &amp; \mathbf{A}_{pp}^{-1}
\end{array}
\right]
\]</span> where subscript <span class="math inline">\(n\)</span> in
<span class="math inline">\(\mathbf{A}^{-1}\)</span> is for real animals
and the subscript <span class="math inline">\(p\)</span> is for genetic
groups. This <span class="math inline">\(\mathbf{A}^{-1}\)</span> can be
calculated with Henderson’s rule with a small extension (Quaas, 1988).
BLUPF90 supports the groups in a regular framework. The BLUPF90 papers
prefer to use unknown parent groups (UPG) rather than phantom parents or
genetic groups.</p>
<h2 id="files">Files</h2>
<p>We can use the same data file as before
(<code>data_mr03d.txt</code>). The pedigree file
(<code>pedigree_mr03d.txt</code>) has to contain a group code instead of
0 (unknown parent). The pedigree file must contain 4 columns.</p>
<ol type="1">
<li>Animal ID (1 or larger integer).</li>
<li>Sire ID. Can contain a group code.</li>
<li>Dam ID. Can contain a group code.</li>
<li>Missing parent status: 1 = both parents known, 2 = one parent known
and 3 = both parents unknown.</li>
</ol>
<p>A group code must be larger than the last ID for real animals. In
this example, because we have 8 real animals, codes 9 and 10 should be
unknown parent codes. In this example, we have 10 “animals” (actually 8
actual animals + 2 UPG) in the pedigree. The 4th column is needed to
calculate the Mendelian sampling variance for each animal in the
program.</p>
<p>The parameter file is also similar to the previous one. You should
make 2 changes.</p>
<pre data-language="blupf90" data-caption="param_mr03d.txt"><code>DATAFILE
data_mr03d.txt
NUMBER_OF_TRAITS
1
NUMBER_OF_EFFECTS
2
OBSERVATION(S)
5
WEIGHT(S)

EFFECTS:
2 2 cross
1 10 cross       # change the number of animals to 10 including groups
RANDOM_RESIDUAL VALUES
40.0
RANDOM_GROUP
2
RANDOM_TYPE      # use upg = unknown parent groups
add_an_upg
FILE
pedigree_mr03d.txt
(CO)VARIANCES
20.0
OPTION solv_method FSPAK</code></pre>
<h2 id="solutions">Solutions</h2>
<p>We will have the following solutions with the above files.</p>
<pre data-language="text" data-caption="solutions"><code>trait/effect level  solution
   1   1         1          4.35899605
   1   1         2          3.21434490
   1   2         1          0.33201730
   1   2         2          0.17597293
   1   2         3          0.13611581
   1   2         4         -0.16882873
   1   2         5          0.00000000
   1   2         6          0.37131040
   1   2         7         -0.23933070
   1   2         8          0.33117127
   1   2         9          1.09907877
   1   2        10         -0.66967475</code></pre>
<p>Do you think these values are very different from the ones in the
textbook? The left-hand side of mixed model equations is not full-rank;
the groups are treated as fixed so the model contains 2 fixed class
effects. We should calculate the contrast (the difference between the
solutions) to obtain a unique solution. For example, the difference in
breeding values for animal 1 and 2 (<span class="math inline">\(u_1 -
u_2\)</span>) is 0.156; it is consistent between this example and the
textbook.</p>
<p>In the textbook, the author puts the zero-constraint to the group 1
(corresponding to animal 9 here) but BLUPF90 puts the constraint on the
animal 5. BLUPF90 automatically detects linear-dependency in the
equations and puts a constraint to any columns and rows as soon as it
finds it necessary. To make a zero-constraint on the animal 9 in
BLUPF90, replace 9 with 0 in the pedigree file and run BLUPF90 with the
same parameter file. You will obtain the following results.</p>
<pre data-language="text" data-caption="solutions"><code>trait/effect level  solution
   1   1         1          5.45807483
   1   1         2          4.31342367
   1   2         1         -0.76706148
   1   2         2         -0.92310585
   1   2         3         -0.96296296
   1   2         4         -1.26790750
   1   2         5         -1.09907877
   1   2         6         -0.72776838
   1   2         7         -1.33840948
   1   2         8         -0.76790750
   1   2         9          0.00000000
   1   2        10         -1.76875353</code></pre>
<p>Be aware that the numerical error is large because of the very small
data set. Considering the rounding error, those values are at a similar
level to the textbook.</p>
<p>This analysis provides us caution about the solutions of breeding
values from unknown parent groups. Depending on methods or constraints,
we obtain the infinite number of solutions because there is a dependency
between the group effect and the other fixed effects. The raw solutions
have already included the group effects, so we should look at the
difference between the two solutions for comparison. A better way to
express the breeding value is to adjust it with the average of animals
with a similar condition. For example, in dairy cattle, the estimated
breeding value is adjusted with the average of breeding values for cows
born in a specific year. Such a reference population is called a genetic
base. In a population undergoing selection, the average breeding value
is continuously increasing (or decreasing) so the genetic base should be
revised every few years.</p>
<p>One more caution must be given. When using UPG, the square root of
the prediction error variance in the solution file (available by
<code>OPTION sol se</code>) will be nonsense. This is because the
prediction is a combination of BLUE and BLUP (<span
class="math inline">\(\mathbf{Qg}+\mathbf{u}\)</span>) and the
corresponding element of the inverse of the left-hand side matrix does
not give the prediction error variance. If you want to have PEV of the
breeding value, you have to use a workaround — just to use the non-UPG
model for the PEV computation.</p>
<p>
Back to <a href="./index.html">index.html</a>.
</p>
</article>
</body>
</html>
