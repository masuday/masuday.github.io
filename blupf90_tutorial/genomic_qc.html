<!DOCTYPE html>
<!--==============================================================================
	           "GitHub HTML5 Pandoc Template" v1.2 — by Tristano Ajmone
	==============================================================================
	(c) Tristano Ajmone, 2017, MIT License (MIT). Project's home repository:

	- https://github.com/tajmone/pandoc-goodies

	This template reuses source code taken from the following projects:

	- GitHub Markdown CSS: © Sindre Sorhus, MIT License (MIT):
	  https://github.com/sindresorhus/github-markdown-css

	- Primer CSS: © 2016 GitHub Inc., MIT License (MIT):
	  http://primercss.io/
	==============================================================================-->
<html>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Yutaka Masuda" />
  <title>Practical genomic analysis</title>
  <style type="text/css">@font-face{font-family:octicons-link;src:url(data:font/woff;charset=utf-8;base64,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) format('woff')}.markdown-body{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#24292e;font-family:-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-size:16px;line-height:1.5;word-wrap:break-word;box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto;padding:45px}.markdown-body .octicon{display:inline-block;fill:currentColor;vertical-align:text-bottom}.markdown-body a{background-color:transparent;-webkit-text-decoration-skip:objects;color:#0366d6;text-decoration:none}.markdown-body a:active,.markdown-body a:hover{outline-width:0}.markdown-body h1{margin:.67em 0}.markdown-body img{border-style:none}.markdown-body svg:not(:root){overflow:hidden}.markdown-body code,.markdown-body kbd,.markdown-body pre{font-family:monospace,monospace}.markdown-body input{font:inherit;margin:0;overflow:visible;font-family:inherit;font-size:inherit;line-height:inherit}.markdown-body [type=checkbox]{box-sizing:border-box;padding:0}.markdown-body *{box-sizing:border-box}.markdown-body a:hover{text-decoration:underline}.markdown-body strong{font-weight:600}.markdown-body hr{box-sizing:content-box;overflow:hidden;background:0 0;border-bottom:1px solid #dfe2e5}.markdown-body hr::before{display:table;content:""}.markdown-body hr::after{display:table;clear:both;content:""}.markdown-body table{border-spacing:0;border-collapse:collapse;display:block;width:100%;overflow:auto}.markdown-body td,.markdown-body th{padding:0}.markdown-body blockquote{margin:0}.markdown-body ol ol,.markdown-body ul ol{list-style-type:lower-roman}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type:lower-alpha}.markdown-body dd{margin-left:0}.markdown-body code{font-family:SFMono-Regular,Consolas,"Liberation Mono",Menlo,Courier,monospace}.markdown-body pre{font:12px SFMono-Regular,Consolas,"Liberation Mono",Menlo,Courier,monospace;word-wrap:normal}.markdown-body .pl-0{padding-left:0!important}.markdown-body .pl-1{padding-left:4px!important}.markdown-body .pl-2{padding-left:8px!important}.markdown-body .pl-3{padding-left:16px!important}.markdown-body .pl-4{padding-left:24px!important}.markdown-body .pl-5{padding-left:32px!important}.markdown-body .pl-6{padding-left:40px!important}.markdown-body::before{display:table;content:""}.markdown-body::after{display:table;clear:both;content:""}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:0}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e1e4e8;border:0}.markdown-body blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd{font-size:11px;box-shadow:inset 0 -1px 0 #959da5}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1{padding-bottom:.3em;font-size:2em;border-bottom:1px solid #eaecef}.markdown-body h2{padding-bottom:.3em;font-size:1.5em;border-bottom:1px solid #eaecef}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#6a737d}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:600}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table th{font-weight:600}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #dfe2e5}.markdown-body table tr{background-color:#fff;border-top:1px solid #c6cbd1}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body code{padding:.2em 0;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code::after,.markdown-body code::before{letter-spacing:-.2em;content:"\00a0"}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:0 0;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px}.markdown-body pre code{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code::after,.markdown-body pre code::before{content:normal}.markdown-body .full-commit .btn-outline:not(:disabled):hover{color:#005cc5;border-color:#005cc5}.markdown-body kbd{display:inline-block;padding:3px 5px;font:11px SFMono-Regular,Consolas,"Liberation Mono",Menlo,Courier,monospace;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fcfcfc;border:1px solid #c6cbd1;border-bottom-color:#959da5;border-radius:3px;box-shadow:inset 0 -1px 0 #959da5}.markdown-body :checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}.markdown-body .task-list-item{list-style-type:none}.markdown-body .task-list-item+.task-list-item{margin-top:3px}.markdown-body .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}.markdown-body hr{border-bottom-color:#eee}.flash{position:relative;padding:16px;color:#246;background-color:#e2eef9;border:1px solid #bac6d3;border-radius:3px}.flash p:last-child{margin-bottom:0}.flash-messages{margin-bottom:24px}.flash-warn{color:#4c4a42;background-color:#fff9ea;border-color:#dfd8c2}.flash-error{color:#911;background-color:#fcdede;border-color:#d2b2b2}.flash-success{color:#22662c;background-color:#e2f9e5;border-color:#bad3be}.flash-plain{color:#4c4a42;background-color:#f5f5f5;border-color:#c1c1c1}</style>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">pre[data-language='renumf90']{background-color:#EFEFFE;}</style>
  <style type="text/css">pre[data-language='blupf90']{background-color:#E7FFE7;}</style>
  <style type="text/css">pre[data-language='output']{background-color:#FFFFFF;border:thin solid black;}</style>
  <style type="text/css">pre[data-language='shell']{background-color:#FFFFFF;border:thin dashed;}</style>
  <style type="text/css">pre[data-caption]::before{content:attr(data-caption) "\a\a";font-size:large;font-weight:bold;border-bottom:thin solid black}</style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<article class="markdown-body">
<header>
<h1 class="title">Practical genomic analysis</h1>
<p class="author">Yutaka Masuda</p>
<p class="date">September 2019</p>
</header>
<nav id="TOC">
<ul>
<li><a href="#quality-control-of-snp-markers">Quality control of SNP markers</a><ul>
<li><a href="#basic-quality-control-options">Basic quality control options</a></li>
<li><a href="#detailed-quality-control-options">Detailed quality control options</a></li>
<li><a href="#extra-options-for-quality-control">Extra options for quality control</a></li>
<li><a href="#numerical-example-for-quality-control">Numerical example for quality control</a></li>
</ul></li>
</ul>
</nav>
<h1 id="quality-control-of-snp-markers">Quality control of SNP markers</h1>
<h2 id="basic-quality-control-options">Basic quality control options</h2>
<p>The genomic module performs the quality control of SNP markers. This process removes unqualified markers and genotyped animals from the original data. The genomic module supports a variety of options for the quality control of markers. The following options change the behavior of the genomic module.</p>
<h3 id="save-cleaned-genotypes">Save cleaned genotypes</h3>
<p>The following option saves the cleaned marker information to files. By default, this option is off and the cleaned genotypes will not be saved.</p>
<pre data-language="blupf90"><code>OPTION saveCleanSNPs</code></pre>
<p>This option generates 4 new files. We assume <code>snpfile</code> as a marker file.</p>
<ul>
<li><code>snpfile_clean</code> = new SNP marker file.</li>
<li><code>snpfile_clean_XrefID</code> = new cross-reference file.</li>
<li><code>snpfile_SNPs_removed</code> = a list of removed markers.</li>
<li><code>snpfile_Animals_removed</code> = a list of removed animals.</li>
</ul>
<h3 id="turn-off-the-quality-control">Turn off the quality control</h3>
<p>By default, the program performs quality control. The following option skips the quality control process completely. Some statistics related to quality control may still be calculated.</p>
<pre data-language="blupf90"><code>OPTION no_quality_control</code></pre>
<p>All the markers and genotyped animals will be retained even if they have obvious error or issues. This option is useful especially when all the markers have already been quality-controlled.</p>
<h2 id="detailed-quality-control-options">Detailed quality control options</h2>
<p>The following table shows useful options for this purpose. Some options have additional arguments but you can omit them. If you omit the arguments, the default values are used. Some details will not be checked. See the Default column in the following table. A detailed explanation for each option can be found in the official manual.</p>
<table>
<colgroup>
<col style="width: 37%" />
<col style="width: 8%" />
<col style="width: 26%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr class="header">
<th>Option name</th>
<th>Default</th>
<th>Possible arguments</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>minfreq x</code></td>
<td>Enable</td>
<td><span class="math inline">\(0 \leq x \leq 1\)</span> (default:x = 0.05)</td>
<td>Minimum allele frequency to retain the marker</td>
</tr>
<tr class="even">
<td><code>callrate x</code></td>
<td>Enable</td>
<td><span class="math inline">\(0 \leq x \leq 1\)</span> (default:x = 0.90)</td>
<td>Minimum call rate for markers</td>
</tr>
<tr class="odd">
<td><code>callrateAnim x</code></td>
<td>Enable</td>
<td><span class="math inline">\(0 \leq x \leq 1\)</span> (default:x = 0.90)</td>
<td>Minimum call rate for animals</td>
</tr>
<tr class="even">
<td><code>monomorphic x</code></td>
<td>Enable</td>
<td>0 or 1 (default:1)</td>
<td>Remove monomorphic markers</td>
</tr>
<tr class="odd">
<td><code>hwe x</code></td>
<td>Skip</td>
<td>any real values (default:x = 0.15)</td>
<td>Maximum deviation of heterozygote frequency from expected</td>
</tr>
<tr class="even">
<td><code>high_correlation x y</code></td>
<td>Skip</td>
<td><span class="math inline">\(-1 &lt; x\)</span>, <span class="math inline">\(y &lt; 1\)</span> (default: x = 0.025 and y = 0.995)</td>
<td>Prune highly correlated markers</td>
</tr>
<tr class="odd">
<td><code>verify_parentage x</code></td>
<td>Enable</td>
<td>0,1,2 or 3 (default:3)</td>
<td>Check the Mendelian coherence of parent and offspring</td>
</tr>
<tr class="even">
<td><code>exclusion_threshold x</code></td>
<td>Enable</td>
<td><span class="math inline">\(0 &lt; x &lt; 100\)</span> % (default:x = 1%)</td>
<td>Acceptance percentage of Mendelian coherence</td>
</tr>
<tr class="odd">
<td><code>exclusion_threshold_snp x</code></td>
<td>Enable</td>
<td><span class="math inline">\(0 &lt; x &lt; 100\)</span> % (default x = 20%)</td>
<td>Acceptance percentage of Mendelian coherence</td>
</tr>
<tr class="even">
<td><code>number_parent_progeny_evaluation x</code></td>
<td>Enable</td>
<td>integer value (default:100)</td>
<td>Minimum number of tests for Mendelian coherence</td>
</tr>
<tr class="odd">
<td><code>threshold_duplicate_samples x</code></td>
<td>Enable</td>
<td><span class="math inline">\(-1 &lt; x &lt; 1\)</span> (default:x = 0.9)</td>
<td>Check too high genomic relationships (duplicate samples)</td>
</tr>
<tr class="even">
<td><code>threshold_diagonal_g x</code></td>
<td>Enable</td>
<td>real value (default:x = 1.6)</td>
<td>Check too high genomic inbreeding</td>
</tr>
<tr class="odd">
<td><code>thrWarnCorAG x</code></td>
<td>Enable</td>
<td><span class="math inline">\(-1 &lt; x &lt; 1\)</span> (default:x = 0.50)</td>
<td>Warning: low resemblance <span class="math inline">\(\mathbf{A}_{22}\)</span> and <span class="math inline">\(\mathbf{G}\)</span></td>
</tr>
<tr class="even">
<td><code>thrStopCorAG x</code></td>
<td>Enable</td>
<td><span class="math inline">\(-1 &lt; x &lt; 1\)</span> (default:x = 0.30)</td>
<td>Error: low resemblance <span class="math inline">\(\mathbf{A}_{22}\)</span> and <span class="math inline">\(\mathbf{G}\)</span></td>
</tr>
<tr class="odd">
<td><code>thrCorAG x</code></td>
<td>Enable</td>
<td><span class="math inline">\(-1 &lt; x &lt; 1\)</span> (default:x = 0.02)</td>
<td>Which values of <span class="math inline">\(\mathbf{A}_{22}\)</span> will be considered for the above</td>
</tr>
</tbody>
</table>
<h2 id="extra-options-for-quality-control">Extra options for quality control</h2>
<p>The following options provide extra information from quality control.</p>
<table>
<colgroup>
<col style="width: 31%" />
<col style="width: 13%" />
<col style="width: 25%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr class="header">
<th>Option name</th>
<th>Default</th>
<th>Possible arguments</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>chrinfo file</code></td>
<td>Skip</td>
<td>characters</td>
<td>Specify the chromosome map file</td>
</tr>
<tr class="even">
<td><code>excludeCHR n1 n2</code> …</td>
<td>Skip</td>
<td>integer values</td>
<td>Specify the chromosome numbers to be excluded from quality control</td>
</tr>
<tr class="odd">
<td><code>sex_chr n</code></td>
<td>Skip</td>
<td>integer value</td>
<td>Specify the number for the sex chromosome in the marker file</td>
</tr>
<tr class="even">
<td><code>plotpca</code></td>
<td>Skip</td>
<td>none</td>
<td>Plot the first two principal components of <span class="math inline">\(\mathbf{G}\)</span></td>
</tr>
<tr class="odd">
<td><code>outcallrate</code></td>
<td>Skip</td>
<td>none</td>
<td>Save the call rate information on SNP markers in the file</td>
</tr>
</tbody>
</table>
<h2 id="numerical-example-for-quality-control">Numerical example for quality control</h2>
<h3 id="files">Files</h3>
<p>We will examine the quality control with a small example including unqualified markers and animals. The following files will be used in this section.</p>
<pre data-language="text" data-caption="snpqc1_XrefID.txt"><code>11 ID002
15 ID003
12 ID004
2 ID006
5 ID010
7 ID011
8 ID012
9 ID013
1 ID015</code></pre>
<p>The original SNP file is also prepared.</p>
<pre data-language="widetext" data-caption="snpqc1.txt"><code>ID002 12120201110012112120001020012020222011120001100201020110010122121101221000012101
ID003 15120251111512112211105021012021521121110005110112111010051011111112225001100110
ID004 22220202001101222101210011000222211021110000100112020200020022220002220000201200
ID006 21220201011002211211112121001121111122120001010122111110012012111120221002012201
ID010 21111211011112101212111122102020212112110001100212111110011012111011221001112210
ID011 22111212001211112202110112101121211112010001200112020200020022220002220000212210
ID012 22220202001101222101210011000222211021110000100112020200020022220002220000201200
ID013 21220201012101211212221012001121221022120000100122111110011012111011221001102200
ID015 21220201012101211212221012001121221022120000100122111110011012111011221001102200</code></pre>
<p>This marker file is the same as the previous chapter except that there are many missing genotypes in the animal <code>ID003</code>. This animal is expected to be removed during quality control.</p>
<p>The data file is as follows.</p>
<pre data-language="text" data-caption="dataqc1.txt"><code> 3.0 1 1 1.0  2
 2.0 1 2 1.0  6
 4.0 1 1 2.0  8
 6.0 2 2 2.0  3
 3.0 2 1 1.0  5
 6.0 2 2 2.0  9
 6.0 3 1 2.0  4
 6.0 3 2 1.0  7
 8.0 3 1 1.0 10
 4.0 3 2 2.0  1</code></pre>
<p>Here is the pedigree file.</p>
<pre data-language="text" data-caption="pedigreeqc1.txt"><code>1 7 5 1 0 2 1 0 0 ID015
13 17 18 3 0 0 0 0 2 ID004
11 17 19 3 0 0 0 0 1 ID005
2 16 18 3 0 0 1 0 1 ID006
3 12 11 1 0 2 1 2 0 ID007
4 14 13 1 0 2 1 0 1 ID008
5 3 2 1 0 2 1 0 2 ID010
6 12 15 1 0 2 1 1 0 ID009
7 3 13 1 0 2 1 3 0 ID011
8 7 4 1 0 2 1 0 0 ID012
14 16 19 3 0 0 0 1 0 ID001
9 7 5 1 0 2 1 0 1 ID013
12 17 18 3 0 0 0 2 0 ID002
10 6 9 1 0 2 1 0 0 ID014
15 16 18 3 0 0 0 0 1 ID003</code></pre>
<p>We will use the following parameter file for PREGSF90. The program will save the cleaned genotypes as well as call-rate information. We put a loose criterion for several options because of the small data. For example, we put a low call-rate criterion and relax the criterion for the correlation between <span class="math inline">\(\mathbf{G}\)</span> and <span class="math inline">\(\mathbf{A}_{22}\)</span>. It is just a demonstration, so do not use such low values in the real data set.</p>
<pre data-language="blupf90" data-caption="paramqc1.txt"><code># BLUPF90 parameter file created by RENF90
DATAFILE
dataqc1.txt
NUMBER_OF_TRAITS
           1
NUMBER_OF_EFFECTS
           4
OBSERVATION(S)
    1
WEIGHT(S)

EFFECTS: POSITIONS_IN_DATAFILE NUMBER_OF_LEVELS TYPE_OF_EFFECT[EFFECT NESTED]
  2         3 cross
  3         2 cross
  4 1 cov
  5        15 cross
RANDOM_RESIDUAL VALUES
   2.0000
 RANDOM_GROUP
     4
 RANDOM_TYPE
 add_animal
 FILE
pedigreeqc1.txt
(CO)VARIANCES
  0.50000
OPTION SNP_file snpqc1.txt snpqc1_XrefID.txt
OPTION callrate 0.80
OPTION thrStopCorAG 0.10
OPTION outcallrate
OPTION saveCleanSNPs</code></pre>
<h3 id="resulting-files">Resulting files</h3>
<p>You will see the following results.</p>
<ul>
<li>The new marker file <code>snpqc1.txt</code> clean is created. The corresponding new cross-reference file is <code>snpqc1.txt_clean_XrefID</code>.</li>
<li>The removed markers are listed in <code>snpqc1.txt_SNPs_removed</code>. You can see 20 markers are removed.</li>
<li>The removed animals are listed in <code>snpqc1.txt_Animals_removed</code>. The second animal (pedigree ID 15 = <code>ID003</code>) is removed due to low call rate.</li>
<li>Allele frequency after quality control is saved in <code>freqdata.count.after.clean</code>. The frequency for a removed marker is shown as 0.0.</li>
<li>The call rate values in the files (<code>callrate</code> and <code>callrate_a</code>) are calculated based on the original marker data.</li>
</ul>
<p>You also find there is the file <code>GimA22i</code>. What values does it have? The following is the dump of this file.</p>
<pre data-language="output"><code>-0.335  0.000  -0.161 -0.421 -0.091  0.405  -0.329   0.265   0.265
 0.000  0.000   0.000  0.000  0.000  0.000   0.000   0.000   0.000
-0.161  0.000  10.624 -0.101  0.614  0.005 -11.035  -0.144  -0.144
-0.421  0.000  -0.101  0.212 -0.018  0.537  -0.154  -0.342  -0.342
-0.091  0.000   0.614 -0.018  0.773 -2.964   1.684   0.291   0.291
 0.405  0.000   0.005  0.537 -2.964  0.064  -0.796   1.421   1.421
-0.329  0.000 -11.035 -0.154  1.684 -0.796  11.503  -0.587  -0.587
 0.265  0.000  -0.144 -0.342  0.291  1.421  -0.587  20.186 -20.738
 0.265  0.000  -0.144 -0.342  0.291  1.421  -0.587 -20.738  20.186</code></pre>
<p>You can see this file has <span class="math inline">\(9 \times 9\)</span> matrix and the second animal is not actually removed from <span class="math inline">\(\mathbf{G}^{-1}-\mathbf{A}_{22}^{-1}\)</span>. This matrix was calculated based on the cleaned markers keeping rows and columns corresponding to removed animals. The program just filled 0 in such rows and columns. This is technically identical to use reconstructed relationship matrices calculated from the cleaned marker file.</p>
<p>When you invoke genomic module from the application programs (BLUPF90, AIREMLF90, GIBBSF90, etc.), the above <code>GimA22i</code> will be directly used in the analysis. When you use PREGSF90, be careful when you use this <code>GimA22i</code> file. This file still corresponds to the original marker and cross-reference file, not to the cleaned files. For instance, if there is one animal that has been excluded by quality control, this animal is still present in <code>GimA22i</code> file (filled with 0 for all related elements). This situation really confuses the user. There is also another issue. If you want to have the final matrix (<span class="math inline">\(\mathbf{G}^{-1}-\mathbf{A}_{22}^{-1}\)</span>) from the cleaned genotypes, it is a waste of time to compute the matrix retaining unqualified objects.</p>
<h3 id="better-practice-for-quality-control">Better practice for quality control</h3>
<p>We suggest a user follow a protocol for quality control of markers.</p>
<ol type="1">
<li>Perform only the quality control, and save the cleaned genotypes with PREGSF90.</li>
<li>Run PREGSF90 again to calculate and save the relationship matrices using the cleaned marker files.</li>
<li>Run an application program for your favorite analysis.</li>
</ol>
<p>To be short, our suggestion is to do the creation of cleaned files as a separate step. This means you need a different parameter file in each step (3 parameter files needed in total). In spite of more effort, the above procedure can avoid the confusion raised from the removal of markers and animals during quality control.</p>
<p>There is another software, QCF90 (quality-control-F-90), which supports non-renumbered files. This tutorial does not cover the usage of QCF90. When QCF90 is used, the process will be</p>
<ol type="1">
<li>Perform quality control and output the cleaned genotypes with QCF90.</li>
<li>Run PREGSF90 to calculate and save the relationship matrices using the cleaned marker files.</li>
<li>Run an application program for your favorite analysis.</li>
</ol>
<p>If you want to create the cleaned files only, in other words, if you want to skip all subsequent steps after the creation of the cleaned files, the following options are helpful.</p>
<pre data-language="blupf90"><code>OPTION createA22 0           # doesn&#39;t create A22
OPTION createA22Inverse 0    # doesn&#39;t compute A22-inverse
OPTION createG 0             # doesn&#39;t create G
OPTION createGInverse 0      # doesn&#39;t compute G-inverse
OPTION createGimA22i 0       # doesn&#39;t compute (G-inv - A22-inv)</code></pre>
<p>With these 5 options, the correlation between <span class="math inline">\(\mathbf{G}\)</span> and <span class="math inline">\(\mathbf{A}_{22}\)</span> will not be calculated. You can calculate such statistics using the cleaned files.</p>
</article>
</body>
</html>
