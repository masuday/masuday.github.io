<!DOCTYPE html>
<!--==============================================================================
	           "GitHub HTML5 Pandoc Template" v1.2 — by Tristano Ajmone
	==============================================================================
	(c) Tristano Ajmone, 2017, MIT License (MIT). Project's home repository:

	- https://github.com/tajmone/pandoc-goodies

	This template reuses source code taken from the following projects:

	- GitHub Markdown CSS: © Sindre Sorhus, MIT License (MIT):
	  https://github.com/sindresorhus/github-markdown-css

	- Primer CSS: © 2016 GitHub Inc., MIT License (MIT):
	  http://primercss.io/
	==============================================================================-->
<html>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Yutaka Masuda" />
  <title>External libraries</title>
  <style type="text/css">@font-face{font-family:octicons-link;src:url(data:font/woff;charset=utf-8;base64,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) format('woff')}.markdown-body{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#24292e;font-family:-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-size:16px;line-height:1.5;word-wrap:break-word;box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto;padding:45px}.markdown-body .octicon{display:inline-block;fill:currentColor;vertical-align:text-bottom}.markdown-body a{background-color:transparent;-webkit-text-decoration-skip:objects;color:#0366d6;text-decoration:none}.markdown-body a:active,.markdown-body a:hover{outline-width:0}.markdown-body h1{margin:.67em 0}.markdown-body img{border-style:none}.markdown-body svg:not(:root){overflow:hidden}.markdown-body code,.markdown-body kbd,.markdown-body pre{font-family:monospace,monospace}.markdown-body input{font:inherit;margin:0;overflow:visible;font-family:inherit;font-size:inherit;line-height:inherit}.markdown-body [type=checkbox]{box-sizing:border-box;padding:0}.markdown-body *{box-sizing:border-box}.markdown-body a:hover{text-decoration:underline}.markdown-body strong{font-weight:600}.markdown-body hr{box-sizing:content-box;overflow:hidden;background:0 0;border-bottom:1px solid #dfe2e5}.markdown-body hr::before{display:table;content:""}.markdown-body hr::after{display:table;clear:both;content:""}.markdown-body table{border-spacing:0;border-collapse:collapse;display:block;width:100%;overflow:auto}.markdown-body td,.markdown-body th{padding:0}.markdown-body blockquote{margin:0}.markdown-body ol ol,.markdown-body ul ol{list-style-type:lower-roman}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type:lower-alpha}.markdown-body dd{margin-left:0}.markdown-body code{font-family:SFMono-Regular,Consolas,"Liberation Mono",Menlo,Courier,monospace}.markdown-body pre{font:12px SFMono-Regular,Consolas,"Liberation Mono",Menlo,Courier,monospace;word-wrap:normal}.markdown-body .pl-0{padding-left:0!important}.markdown-body .pl-1{padding-left:4px!important}.markdown-body .pl-2{padding-left:8px!important}.markdown-body .pl-3{padding-left:16px!important}.markdown-body .pl-4{padding-left:24px!important}.markdown-body .pl-5{padding-left:32px!important}.markdown-body .pl-6{padding-left:40px!important}.markdown-body::before{display:table;content:""}.markdown-body::after{display:table;clear:both;content:""}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:0}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e1e4e8;border:0}.markdown-body blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd{font-size:11px;box-shadow:inset 0 -1px 0 #959da5}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1{padding-bottom:.3em;font-size:2em;border-bottom:1px solid #eaecef}.markdown-body h2{padding-bottom:.3em;font-size:1.5em;border-bottom:1px solid #eaecef}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#6a737d}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:600}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table th{font-weight:600}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #dfe2e5}.markdown-body table tr{background-color:#fff;border-top:1px solid #c6cbd1}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px}.markdown-body .full-commit .btn-outline:not(:disabled):hover{color:#005cc5;border-color:#005cc5}.markdown-body kbd{display:inline-block;padding:3px 5px;font:11px SFMono-Regular,Consolas,"Liberation Mono",Menlo,Courier,monospace;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fcfcfc;border:1px solid #c6cbd1;border-bottom-color:#959da5;border-radius:3px;box-shadow:inset 0 -1px 0 #959da5}.markdown-body :checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}.markdown-body .task-list-item{list-style-type:none}.markdown-body .task-list-item+.task-list-item{margin-top:3px}.markdown-body .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}.markdown-body hr{border-bottom-color:#eee}.flash{position:relative;padding:16px;color:#246;background-color:#e2eef9;border:1px solid #bac6d3;border-radius:3px}.flash p:last-child{margin-bottom:0}.flash-messages{margin-bottom:24px}.flash-warn{color:#4c4a42;background-color:#fff9ea;border-color:#dfd8c2}.flash-error{color:#911;background-color:#fcdede;border-color:#d2b2b2}.flash-success{color:#22662c;background-color:#e2f9e5;border-color:#bad3be}.flash-plain{color:#4c4a42;background-color:#f5f5f5;border-color:#c1c1c1}</style>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">pre[data-language='renumf90']{background-color:#EFEFFE;}</style>
  <style type="text/css">pre[data-language='Fortran']{background-color:#E7FFE7;}</style>
  <style type="text/css">pre[data-language='output']{background-color:#FFFFFF;border:thin solid black;}</style>
  <style type="text/css">pre[data-language='shell']{background-color:#FFFFFF;border:thin dashed;}</style>
  <style type="text/css">pre[data-caption]::before{content:attr(data-caption) "\a\a";font-size:large;font-weight:bold;border-bottom:thin solid black}</style>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <link rel="stylesheet" href="prism.css">
  <script type="text/javascript" src="prism.js"></script>
</head>
</head>
<body>
<article class="markdown-body">
<header>
<h1 class="title">External libraries</h1>
<p class="author">Yutaka Masuda</p>
<p class="date">January 2020</p>
</header>
<nav id="TOC">
<ul>
<li><a href="#external-libraries">External libraries</a><ul>
<li><a href="#free-libraries-for-fortran">Free libraries for Fortran</a></li>
<li><a href="#blas-and-lapack">BLAS and LAPACK</a></li>
<li><a href="#lapack95">LAPACK95</a></li>
<li><a href="#ranlib">RANLIB</a></li>
<li><a href="#cdflib">CDFLIB</a></li>
<li><a href="#other-libraries">Other libraries</a></li>
</ul></li>
</ul>
</nav>
<p>
Back to <a href="./index.html">index.html</a>.
</p>
<h1 id="external-libraries">External libraries</h1>
<h2 id="free-libraries-for-fortran">Free libraries for Fortran</h2>
<p>Fortran is a plain programming language. It serves primitive statements and many, but simple intrinsic functions. Although these resources are enough to perform scientific operations (e.g., eigenvalue decomposition), Fortran does not provide such high-level procedures. Fortran has a long history, and many users have already had private subroutines useful in their work. Also, some companies provide popular commercial products, e.g., Intel Math Kernel Library (MKL), NAG Numerical Library, and IMSL Numerical Libraries. They are optional, and therefore, it is responsible for the user to prepare the external software.</p>
<p>Currently, a <a href="https://github.com/fortran-lang/stdlib">open-source project</a> is moving forward to create the “standard library” in Fortran. It is going to have many essential procedures useful in scientific computing. While many professionals join this project, it may take time to finish developing the library.</p>
<p>Fortunately, besides the “standard library”, the past scientists and engineers have developed and released frequently-used subroutines available online under an explicit license at no cost. Some are old but still useful. In this chapter, we look at some external libraries and pack it as a custom module for future use.</p>
<h2 id="blas-and-lapack">BLAS and LAPACK</h2>
<p>BLAS (Basic Linear Algebra Subprograms) is a collection of Fortran subroutines for basic matrix/vector operations, mainly dedicated to matrix multiplications. LAPACK (Linear Algebra Package) is a library to perform well-known matrix operations such as Cholesky factorization, inversion, solution of linear equations, eigenvalue problems, and so on. LAPACK depends on BLAS. Some companies and research groups have optimized BLAS to enable parallel computations. The optimized BLAS accelerates the LAPACK subroutines, and therefore, you should use it in your serious studies. In this section, we are going to use a reference implementation i.e., non-optimized Fortran library. BLAS and LAPACK are available under the <a href="https://opensource.org/licenses/BSD-3-Clause">BSD license</a>, an open-source license.</p>
<p>Here is an instruction to build the library.</p>
<ol type="1">
<li>Download the latest version of the package from <a href="http://www.netlib.org/lapack/">the official website</a>. The package contains both BLAS and LAPACK.</li>
<li>Extract the package and move into the directory.</li>
<li>Rename <code>make.inc.example</code> to <code>make.inc</code>.
<ul>
<li>If you are using GFortran, do not touch this file anymore.</li>
<li>If you are using the other compiler (e.g., <code>ifort</code>), open this file, and rewrite the macros: <code>FC</code>, <code>FFLAGS</code>, and <code>FFLAGS_NOOPT</code>.</li>
</ul></li>
<li>Type <code>make blaslib</code> to compile the BLAS library.</li>
<li>Type <code>BUILD_DEPRECATED=yes make lapacklib</code> to compile the LAPACK library.
<ul>
<li>Without <code>BUILD_DEPRECATED</code>, you should fail in the compilation of LAPACK95.</li>
<li>If you cannot use it in the terminal, modify <code>make.inc</code> to activate this variable.</li>
</ul></li>
<li>The compiled libraries, <code>librefblas.a</code> and <code>liblapack.a</code>, are available in the current directory. Copy these files to your directory.</li>
</ol>
<p>If you want to test the libraries, type <code>make blas_testing</code> and <code>make lapack_testing</code>. The tests may need a long time to finish.</p>
<p>For BLAS, a test program is <a href="./lib/test_blas.f90">available</a>. With GFortran, the following command compiles the file.</p>
<pre data-language="shell"><code>gfortran test_blas.f90 librefblas.a</code></pre>
<p>A test program for LAPACK is <a href="./lib/test_lapack.f90">available</a>. It needs both BLAS and LAPACK (LAPACK comes first in the command line).</p>
<pre data-language="shell"><code>gfortran test_lapack.f90 liblapack.a librefblas.a</code></pre>
<h2 id="lapack95">LAPACK95</h2>
<p>BLAS and LAPACK have many external subroutines. The style of the procedure is based on FORTRAN 77, and it is not easy to use. LAPACK95 provides some modules with the interface to selected subroutines. Unfortunately, this program is very old, and you would have some issues in the compilation. The license statement is found in the manual:</p>
<blockquote>
<p>Since LAPACK95 is freely available, it can be included in commercial packages. It is requested only that proper credit be given to the authors by citing this Users’ Guide as the official reference for LAPACK95. Like all software, this package is copyrighted. It is not trademarked; however, if modifications are made that affect the interface, functionality, or accuracy of the resulting software, the name of the routine should be changed. Any modification to the software should be noted in the modifier’s documentation.</p>
</blockquote>
<p>Here is the instruction for building the library.</p>
<ol type="1">
<li>Download the package from <a href="https://www.netlib.org/lapack95/">the official website</a>.</li>
<li>Extract the package and move into the directory.</li>
<li>Rewrite <code>make.inc</code>.
<ul>
<li>For GFortran, put <code>FC=gfortran</code>, <code>FC1=gfortran</code> and <code>OPTS0=-O3</code>.</li>
<li>For Intel Fortran, use <code>FC=ifort</code>, <code>FC1=ifort</code> and <code>OPTS0=-O3</code>.</li>
</ul></li>
<li>Move into <code>SRC</code>, and type <code>make single_double</code>.</li>
<li>Come back to the original directory with <code>cd ..</code> There is the library, <code>lapack95.a</code>. The mod files are in <code>lapack95_modules</code>.</li>
</ol>
<p>LAPACK95 has modules so you need <code>.mod</code> files in addition to <code>lapack95.a</code>, <code>liblapack.a</code>, and <code>librefblas.a</code>. A test program for LAPACK is <a href="./lib/test_lapack95.f90">available</a>. It needs both BLAS and LAPACK (LAPACK comes first in the command line).</p>
<pre data-language="shell"><code>gfortran test_lapack95.f90 lapack95.a liblapack.a librefblas.a</code></pre>
<h2 id="ranlib">RANLIB</h2>
<p>RANLIB is a library for random number generators written in FORTRAN 77. The original package is available at <a href="http://www.netlib.org/random/">Netlib</a>. I restructured this package to have a module. The license is avauilable from <a href="./lib/README.ranlib77">the official documentation</a>.</p>
<p>The instruction is as follows.</p>
<ol type="1">
<li>Download <a href="./lib/ranlib77.f">the module</a>, <code>ranlib77.f</code>.</li>
<li>Compile it to create an object file with <code>-c</code>.</li>
<li>Convert the object file to a library file: <code>ar cr ranlib77.a ranlib77.o</code>.</li>
</ol>
<p>A test program for RANLIB is <a href="./lib/test_ranlib77.f90">available</a>. You need <code>ranlib77.a</code> and <code>ranlib77.mod</code> to compile the test program.</p>
<pre data-language="shell"><code>gfortran test_ranlib77.f90 ranlib77.a</code></pre>
<h2 id="cdflib">CDFLIB</h2>
<p>RANLIB is a library for various CDF (cumulative distribution functions) written in FORTRAN 77. The original package is available at <a href="http://www.netlib.org/random/">Netlib</a>. I restructured this package to have a module. The license is avauilable from <a href="./lib/README.cdflib77">the official documentation</a>.</p>
<p>The instruction is the same as RANLIB.</p>
<ol type="1">
<li>Download <a href="./lib/cdflib77.f">the module</a>, <code>cdflib77.f</code>.</li>
<li>Compile it to create an object file with <code>-c</code>.</li>
<li>Convert the object file to a library file: <code>ar cr cdflib77.a cdflib77.o</code>.</li>
</ol>
<p>A test program for CDFLIB is <a href="./lib/test_cdflib77.f90">available</a>. You need <code>cdflib77.a</code> and <code>cdflib77.mod</code> to compile the test program.</p>
<pre data-language="shell"><code>gfortran test_cdflib77.f90 cdflib77.a</code></pre>
<h2 id="other-libraries">Other libraries</h2>
<p>There are more libraries available online. I show the pointers, and please explore the websites with the care of the license. Note that some programs are very old (written in FORTRAN 77 around the 1970s). It still compiles with the current Fortran compiler (with possible warnings).</p>
<ul>
<li><a href="http://fortranwiki.org/fortran/show/Libraries">Libraries in Fortran Wiki</a></li>
<li><a href="https://jblevins.org/mirror/amiller/">Alan Miller’s Fortran Software</a></li>
<li><a href="https://people.sc.fsu.edu/~jburkardt/">John Burkardt</a></li>
<li><a href="http://www.netlib.org">Netlib</a></li>
<li><a href="https://gams.nist.gov/cgi-bin/serve.cgi/Package/SLATEC/">SLATEC</a></li>
<li><a href="https://github.com/fortran-lang/stdlib">Fortran stdlib</a>
<ul>
<li><a href="https://github.com/fortran-lang/stdlib/issues/1#issue-537978034">Existing libraries, for inspiration or adoption</a> at the end of the comment.</li>
</ul></li>
</ul>
<p>
Back to <a href="./index.html">index.html</a>.
</p>
</article>
</body>
</html>
